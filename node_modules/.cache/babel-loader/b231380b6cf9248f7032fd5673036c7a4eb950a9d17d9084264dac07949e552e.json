{"ast":null,"code":"var _jsxFileName = \"/Users/stevieburgett/Documents/Springboard/capstone-2/frontend/quizit/src/App.js\",\n  _s = $RefreshSig$();\nimport './css/App.css';\nimport jwt_decode from 'jwt-decode';\nimport axios from 'axios';\nimport React, { useState, useEffect } from 'react';\nimport Router from \"./routes/Router\";\nimport { BrowserRouter } from 'react-router-dom';\nimport Navbar from './components/Navbar';\nimport { useLocalStorage } from './utils/hooks';\nimport UserContext from './utils/UserContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst BASE_URL = process.env.REACT_APP_BASE_URL || \"http://localhost:3001\";\nfunction App() {\n  _s();\n  const [token, setToken] = useLocalStorage('token', null);\n  const [currentUser, setCurrentUser] = useState(null);\n\n  // on token change, get user info and store in current user\n  useEffect(() => {\n    async function getUser() {\n      try {\n        if (!token) return;\n        const payload = jwt_decode(token);\n        const username = payload.username;\n        console.debug(\"ATTEMPTING TO GET USER\", username);\n        res.locals.user = {\n          user: {\n            username\n          }\n        };\n        const user = await request(`users/${username}`);\n        setCurrentUser(user);\n        console.debug(currentUser);\n      } catch {\n        res.locals.user = null;\n        return;\n      }\n    }\n    if (token) getUser();\n  }, [token]);\n  async function request(endpoint) {\n    let data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    let method = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \"get\";\n    console.debug(\"API Call:\", endpoint, data, method);\n\n    //there are multiple ways to pass an authorization token, this is how you pass it in the header.\n    //this has been provided to show you another way to pass the token. you are only expected to read this code for this project.\n    console.log(token);\n    const url = `${BASE_URL}/${endpoint}`;\n    const headers = {\n      Authorization: `Bearer ${token}`\n    };\n    const params = method === \"get\" ? data : {};\n    try {\n      return (await axios({\n        url,\n        method,\n        data,\n        params,\n        headers\n      })).data;\n    } catch (err) {\n      console.error(\"API Error:\", err.response);\n      let message = err.response.data.error.message;\n      throw Array.isArray(message) ? message : [message];\n    }\n  }\n\n  // get token, set token state \n  async function login(username, password) {\n    try {\n      const resp = await axios.post(`auth/token`, {\n        username,\n        password\n      });\n      const token = resp.data.token;\n      setToken(token);\n    } catch {\n      return;\n    }\n  }\n\n  // clear user from state and token in localStorage\n  function logout() {\n    setCurrentUser(null);\n    setToken(null);\n  }\n\n  // register new user and store their token in localStorage\n  async function signup(user) {\n    try {\n      console.debug('ATTEMPTING TO REGISTER USER');\n      const resp = await axios.post(`auth/register`, user);\n      const token = resp.token;\n      console.debug(`User registered, token is ${token}`);\n      if (!token) return;\n      setToken(token);\n    } catch {\n      return;\n    }\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    children: /*#__PURE__*/_jsxDEV(BrowserRouter, {\n      children: /*#__PURE__*/_jsxDEV(UserContext.Provider, {\n        value: {\n          login,\n          logout,\n          signup,\n          currentUser,\n          setCurrentUser,\n          token\n        },\n        children: [/*#__PURE__*/_jsxDEV(Navbar, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(Router, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 91,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"M50fWskUCjzcLcGN+NzrUAXv9pk=\", false, function () {\n  return [useLocalStorage];\n});\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["jwt_decode","axios","React","useState","useEffect","Router","BrowserRouter","Navbar","useLocalStorage","UserContext","jsxDEV","_jsxDEV","BASE_URL","process","env","REACT_APP_BASE_URL","App","_s","token","setToken","currentUser","setCurrentUser","getUser","payload","username","console","debug","res","locals","user","request","endpoint","data","arguments","length","undefined","method","log","url","headers","Authorization","params","err","error","response","message","Array","isArray","login","password","resp","post","logout","signup","className","children","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/stevieburgett/Documents/Springboard/capstone-2/frontend/quizit/src/App.js"],"sourcesContent":["import './css/App.css';\nimport jwt_decode from 'jwt-decode';\nimport axios from 'axios';\nimport React, { useState, useEffect} from 'react';\nimport Router from \"./routes/Router\";\nimport { BrowserRouter } from 'react-router-dom';\nimport Navbar from './components/Navbar';\nimport { useLocalStorage } from './utils/hooks';\nimport UserContext from './utils/UserContext';\n\nconst BASE_URL = process.env.REACT_APP_BASE_URL || \"http://localhost:3001\";\n\nfunction App() {\n    const [token, setToken] = useLocalStorage('token', null)\n    const [currentUser, setCurrentUser] = useState(null)\n  \n    // on token change, get user info and store in current user\n    useEffect(() => {\n      async function getUser() {\n        try {\n          if (!token) return\n          const payload = jwt_decode(token)\n          const username = payload.username\n          console.debug(\"ATTEMPTING TO GET USER\", username)\n          res.locals.user = {user: {username}}\n          const user = await request(`users/${username}`)\n          setCurrentUser(user)\n          console.debug(currentUser)\n        } catch {\n          res.locals.user = null\n          return\n        }\n      }\n      if (token) getUser()\n    }, [token])\n  \n    async function request(endpoint, data = {}, method = \"get\") {\n        console.debug(\"API Call:\", endpoint, data, method);\n    \n        //there are multiple ways to pass an authorization token, this is how you pass it in the header.\n        //this has been provided to show you another way to pass the token. you are only expected to read this code for this project.\n        console.log(token)\n        const url = `${BASE_URL}/${endpoint}`;\n        const headers = { Authorization: `Bearer ${token}` } \n        const params = (method === \"get\")\n            ? data\n            : {};\n    \n        try {\n          return (await axios({ url, method, data, params, headers })).data;\n        } catch (err) {\n          console.error(\"API Error:\", err.response);\n          let message = err.response.data.error.message\n          throw Array.isArray(message) ? message : [message];\n        }\n      }\n\n   // get token, set token state \n   async function login(username, password) {\n    try {\n        const resp = await axios.post(`auth/token`, {username, password})\n        const token = resp.data.token\n        setToken(token)\n    } catch {\n        return\n    }\n\n    }\n  \n    // clear user from state and token in localStorage\n    function logout() {\n      setCurrentUser(null)\n      setToken(null)\n    }\n  \n    // register new user and store their token in localStorage\n    async function signup(user) {\n        try {\n            console.debug('ATTEMPTING TO REGISTER USER')\n            const resp = await axios.post(`auth/register`, user)\n            const token = resp.token\n            console.debug(`User registered, token is ${token}`)\n            if (!token) return\n            setToken(token)\n        } catch {\n            return\n        }\n\n     }\n  return (\n    <div className=\"App\">\n        <BrowserRouter>\n            <UserContext.Provider value={{login, logout, signup, currentUser, setCurrentUser, token}}>\n                <Navbar />\n                <Router />\n            </UserContext.Provider>\n        </BrowserRouter>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}